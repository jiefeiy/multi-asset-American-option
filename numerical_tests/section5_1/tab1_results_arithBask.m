clear, clc, close all
% reference values from the paper by P. Kovalov, V. Linetsky, and M. Marcozzi
V_ref = [3.13955, 2.94454, 2.84019, 2.77193, 2.71838]; 

% pricing arithmetric basket option using the algorithm pricing_GK
% using SGGK with qlevel = 4;
dim = 2:12;
ilevel = 3:7;

nb_dim = size(dim,2);
nb_ilevel = size(ilevel,2);

value = cell(1,nb_dim);
nb_knots_all = cell(1,nb_dim);

% d = 2
value{1} = [2.919304901673705   3.139660558917404   3.133036309179384...
    3.126911984857421   3.138828333382125];
nb_knots_all{1} = [29    13   173;
    65    33   173;
   145    81   173;
   321   193   173;
   705   449   173];

% d = 3
value{2} = [2.864881531013882   2.953266376468984   2.929975460676051...
    2.930385857303037   2.946255254844827];
nb_knots_all{2} = [69          19         495;
         177          55         495;
         441         151         495;
        1073         399         495;
        2561        1023         495];

% d = 4
value{3} = [2.842864613760202   2.854713451008712   2.823202323658871   2.831051672159345];
nb_knots_all{3} = [137          25        1097;
         401          81        1097;
        1105         241        1097;
        2929         689        1097];

% d = 5
value{4} = [2.827055796854028   2.790615343812317   2.760146087684952   2.771026332209624];
nb_knots_all{4} = [241          31        2091;
         801         111        2091;
        2433         351        2091;
        6993        1071        2091];

% d = 6
value{5} = [2.812894210111842   2.745466533090985   2.719085865061566   2.731886468698955];
nb_knots_all{5} = [389          37        3605;
        1457         145        3605;
        4865         481        3605;
       15121        1553        3605];

% d = 7
value{6} = [2.798800716456519   2.713959393279069   2.691296300807275   2.705188603449937];
nb_knots_all{6} = [589          43        5783
        2465         183        5783
        9017         631        5783
       30241        2143        5783];

% d = 8
value{7} = [2.784141888399462   2.690783580342546   2.671837181724886];
nb_knots_all{7} = [849   49   8785;
    3937    225    8785;
    15713	801	   8785];

% d = 9
value{8} = [2.771980133508856   2.669047977714456   2.655300842266351];
nb_knots_all{8} = [1177	  55   12787;
6001	271	  12787;
26017 	991	  12787];

% d = 10
value{9} = [2.759913301746183   2.649811369140877   2.642795689984814];
nb_knots_all{9} = [1581   61   17981;
        8801         321       17981;
       41265        1201       17981];

% d = 11
value{10} = [2.747242943879526   2.633096094056210];
nb_knots_all{10} = [2069          67       24575;
       12497         375       24575];

% d = 12 
value{11} = [2.734546342460911   2.620950086273658];
nb_knots_all{11} = [2649          73       32793;
       17265         433       32793];

disp('-----------reference price-----------');
disp(vpa(V_ref,6));

disp('-----------relative error------------');
re = cell(1,nb_dim);
for i=1:5
    re{i} = abs(value{i} - V_ref(i))./V_ref(i);
    disp({'d=' num2str(i+1) vpa(value{i},5) vpa(re{i},3)});
end
disp('-----------option price------------');

for i = 1:11
    disp({'d=' num2str(i+1) vpa(value{i},5)})
end
disp('-----------------------------------');
